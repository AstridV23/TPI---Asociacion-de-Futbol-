
-- Creación Categoria
CREATE TABLE Categoria ( 
    Categoria_Id INTEGER PRIMARY KEY AUTOINCREMENT, 
    Tipo TEXT, 
    Descripcion TEXT
);

-- Creación Division
CREATE TABLE Division ( 
    Division_Id INTEGER PRIMARY KEY AUTOINCREMENT, 
    Tipo TEXT
);


-- Creación Arbitro
CREATE TABLE Arbitro ( 
    DNI_Arbitro INTEGER PRIMARY KEY NOT NULL, 
    TieneCertificacion INTEGER, -- 0 = false, 1 = true
    NivelExperiencia INTEGER
);

-- Creación Persona
CREATE TABLE Persona ( 
    DNI INTEGER PRIMARY KEY NOT NULL, 
    FechaNacimiento TEXT, 
    Direccion TEXT, 
    Apellido TEXT, 
    Nombre TEXT, 
    Rol TEXT, 
    Contrasena TEXT
);

-- Creación Cancha
CREATE TABLE Cancha ( 
    Cancha_Id INTEGER PRIMARY KEY AUTOINCREMENT, 
    Direccion TEXT, 
    Nombre TEXT
);

-- Creación Fixture
CREATE TABLE Fixture ( 
    Fixture_Id INTEGER PRIMARY KEY AUTOINCREMENT, 
    Cantidad_Ruedas INTEGER
);

-- Creación Torneo
CREATE TABLE Torneo ( 
    Torneo_ID INTEGER PRIMARY KEY AUTOINCREMENT, 
    Categoria_Id INTEGER NOT NULL, 
    Division_Id INTEGER NOT NULL, 
    DNI_Encargado INTEGER NOT NULL, 
    Nombre TEXT NOT NULL, 
    Fecha_Inicio TEXT NOT NULL, 
    Fecha_Fin TEXT NOT NULL, 
    Fecha_Inicio_Inscripcion TEXT NOT NULL, 
    Fecha_Fin_Inscripcion TEXT NOT NULL, 
    FOREIGN KEY (Categoria_Id) REFERENCES Categoria(Categoria_Id), 
    FOREIGN KEY (DNI_Encargado) REFERENCES Persona(DNI), 
    FOREIGN KEY (Division_Id) REFERENCES Division(Division_Id)
);

-- Creación Equipo
CREATE TABLE Equipo ( 
    Nro_Equipo INTEGER PRIMARY KEY NOT NULL, 
    Nombre TEXT, 
    DT TEXT, 
    Division_Id INTEGER, 
    DNI_Representante INTEGER, 
    Categoria_Id INTEGER, 
    FOREIGN KEY (Division_Id) REFERENCES Division(Division_Id),  
    FOREIGN KEY (DNI_Representante) REFERENCES Persona(DNI), 
    FOREIGN KEY (Categoria_Id) REFERENCES Categoria(Categoria_Id)
);

-- Creación Jugador
CREATE TABLE Jugador ( 
    DNI_Jugador INTEGER PRIMARY KEY NOT NULL, 
    Nro_Socio INTEGER, 
    Nro_Equipo INTEGER, 
    Telefono TEXT, 
    Foto BLOB, 
    FOREIGN KEY (Nro_Equipo) REFERENCES Equipo(Nro_Equipo),
    FOREIGN KEY (DNI_Jugador) REFERENCES Persona(DNI)
);

-- Creación Encuentro
CREATE TABLE Encuentro ( 
    Encuentro_Id INTEGER PRIMARY KEY AUTOINCREMENT, 
    DNI_Arbitro INTEGER, 
    Cancha_Id INTEGER, 
    Fecha TEXT, 
    Hora TEXT, 
    FOREIGN KEY (DNI_Arbitro) REFERENCES Arbitro(DNI_Arbitro), 
    FOREIGN KEY (Cancha_Id) REFERENCES Cancha(Cancha_Id)
);

-- Creación Tiene_Torneo_Division
CREATE TABLE Tiene_Torneo_Division ( 
    Torneo_ID INTEGER, 
    Division_Id INTEGER, 
    PRIMARY KEY (Torneo_ID, Division_Id), 
    FOREIGN KEY (Torneo_ID) REFERENCES Torneo(Torneo_ID), 
    FOREIGN KEY (Division_Id) REFERENCES Division(Division_Id)
);

-- Creación Tiene_Torneo_Categoria
CREATE TABLE Tiene_Torneo_Categoria ( 
    Torneo_ID INTEGER, 
    Categoria_Id INTEGER, 
    PRIMARY KEY (Torneo_ID, Categoria_Id), 
    FOREIGN KEY (Torneo_ID) REFERENCES Torneo(Torneo_ID), 
    FOREIGN KEY (Categoria_Id) REFERENCES Categoria(Categoria_Id)
);

-- Creación Rueda
CREATE TABLE Rueda ( 
    Nro_Rueda INTEGER NOT NULL, 
    Fixture_Id INTEGER, 
    PRIMARY KEY(Nro_Rueda, Fixture_Id),
    FOREIGN KEY (Fixture_Id) REFERENCES Fixture(Fixture_Id)
);

-- Creación Se_Compone
CREATE TABLE Se_Compone ( 
    Torneo_ID INTEGER, 
    Fixture_Id INTEGER, 
    Encuentro_Id INTEGER, 
    PRIMARY KEY (Torneo_ID, Fixture_Id, Encuentro_Id), 
    FOREIGN KEY (Torneo_ID) REFERENCES Torneo(Torneo_ID), 
    FOREIGN KEY (Fixture_Id) REFERENCES Fixture(Fixture_Id), 
    FOREIGN KEY (Encuentro_Id) REFERENCES Encuentro(Encuentro_Id)
);

-- Creación Juega
CREATE TABLE Juega ( 
    DNI_Jugador INTEGER, 
    Nro_Equipo INTEGER, 
    Encuentro_Id INTEGER, 
    PRIMARY KEY (DNI_Jugador, Nro_Equipo, Encuentro_Id), 
    FOREIGN KEY (DNI_Jugador) REFERENCES Jugador(DNI_Jugador), 
    FOREIGN KEY (Nro_Equipo) REFERENCES Equipo(Nro_Equipo), 
    FOREIGN KEY (Encuentro_Id) REFERENCES Encuentro(Encuentro_Id)
);

-- Creación Pertenece
CREATE TABLE Pertenece ( 
    DNI_Jugador INTEGER, 
    Nro_Equipo INTEGER, 
    PRIMARY KEY (DNI_Jugador, Nro_Equipo), 
    FOREIGN KEY (DNI_Jugador) REFERENCES Jugador(DNI_Jugador), 
    FOREIGN KEY (Nro_Equipo) REFERENCES Equipo(Nro_Equipo)
);

-- Creación jugador_hace
CREATE TABLE jugador_hace ( 
    DNI_Jugador INTEGER, 
    Encuentro_Id INTEGER, 
    Nro_Equipo INTEGER, 
    gol INTEGER, -- 0 = false, 1 = true
    momento TEXT, 
    PRIMARY KEY (DNI_Jugador, Encuentro_Id, Nro_Equipo), 
    FOREIGN KEY (DNI_Jugador) REFERENCES Jugador(DNI_Jugador), 
    FOREIGN KEY (Encuentro_Id) REFERENCES Encuentro(Encuentro_Id), 
    FOREIGN KEY (Nro_Equipo) REFERENCES Equipo(Nro_Equipo)
);

-- Creación Infraccion
CREATE TABLE Infraccion ( 
    Infraccion_id INTEGER PRIMARY KEY AUTOINCREMENT, 
    Encuentro_Id INTEGER, 
    Minuto INTEGER, 
    Tipo TEXT, 
    DNI_Jugador INTEGER, 
    DNI_Arbitro INTEGER, 
    FOREIGN KEY (Encuentro_Id) REFERENCES Encuentro(Encuentro_Id), 
    FOREIGN KEY (DNI_Jugador) REFERENCES Jugador(DNI_Jugador), 
    FOREIGN KEY (DNI_Arbitro) REFERENCES Arbitro(DNI_Arbitro)
);
